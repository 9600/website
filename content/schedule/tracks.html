---
title: Tracks
no_sponsors: true
---
<%
tracks = @items.select{|i| i.identifier =~ %r{^/schedule/track/.+}}.sort_by{|t| [t[:rank], t[:conference_track_id]]}
days = @items.select{|i| i.identifier =~ %r{^/schedule/day/.+}}.sort_by{|d| d[:conference_day]}
%>
<table class="table table-striped table-bordered table-condensed">
    <thead>
        <tr>
            <th>Track</th>
            <th>Rooms</th>
            <% days.each do |d| %>
            <th><%= d[:title] %></th>
            <% end %>
        </tr>
    </thead>
    <tbody>
        <%
        tracks.each do |t|
        events = t[:events].map{|slug| $item_by_id.fetch("/schedule/event/#{slug}/")}
        %>
        <tr>
            <td><a href="<%= t.path %>"><%= t[:title] %></a></td>
            <td><%= events.map{|e| e[:room]}.uniq.map{|id| $item_by_id.fetch("/schedule/room/#{id}/")}.sort_by{|r| [r[:rank], r[:conference_room_id]]}.map{|r| "<a href=\"#{r.path}\">#{r[:title]}</a>"}.join(", ") %></td>
            <% days.each do |d| %>
            <td><%=
                events_that_day = events.select{|e| e[:conference_day_id] == d[:conference_day_id]}
                if events_that_day.empty?
                "-"
                else
                "#{events_that_day.sort_by{|e| e[:start_time]}.first[:start_time]} - #{events_that_day.sort_by{|e| e[:end_time]}.last[:end_time]}"
                end
                %></td>
            <% end %>
        </tr>
        <% end %>
    </tbody>
</table>
